# PostgresPro test task

Тестовое задание в компанию PostgresPro на стажировку по направлению DevOps-инженер.
Репозиторий содержит файл `script.sh`, который запускает установку postgres на удалённый хост.
Также есть файл `install_postgres_almalinux.sh`, который выполняет непосредственно саму установку
на сервере AlmaLinux. `install_postgres_debian.sh` устанавливает postgres на сервер Debian.

## Инструкция по запуску
Перед запуском надо создать RSA ключ и поместить id_rsa.pub на оба сервера (не создавайте passphrase).
Директорию создания ключа оставьте дефолтной (`~/.ssh/id_rsa`)
```bash
ssh-keygen
ssh-copy-id user@server_ip
```
Также перед запуском надо создать файл pgpassword с паролем от базы данных, которая впоследствии будет запущена на
одном из серверов. Слово password замените на пароль
```bash
touch pgpassword && echo 'password' > pgpassword
```

Перед и после запуска следует выполнять следующую команду для остановки и удаления докер контейнера (ip замените на адрес сервера)
```bash
./stop_docker_container.sh ip
```
Например
```
./stop_docker_container.sh 109.73.205.236
```

Перед запуском скрипта его надо сделать выполняемым
```bash
chmod +x script.sh
```

Скрипт запускается следующей командой из директории проекта, где вместо ip1 и ip2 надо подставить ip-адреса серверов
```bash
./script.sh ip1,ip2
```
Например
```bash
./script.sh 103.88.241.97,109.73.205.236
```

## Вопросы, которые возникли в процессе разработки
1. Как корректно проверить два сервера на загруженность?
2. Стоит ли оценивать сервера только по свободной оперативной памяти или
нужно провести проверку по загруженности процессора и свободному месту на диске?
3. Нужно ли вообще учитывать загруженность процессора, если на разных серверах их может быть разное количество?
4. Стоит ли использовать специальные программы, такие как Grafana и Prometheus, для проверки загрузки системы?
5. Как разрешить подключение к базе данных под юзером student только со вторичного, более загруженного ip адреса?
